# 快取管理功能說明

## 📋 概述

股市大亨 LINE Bot 提供快取管理功能，讓所有用戶都可以清除無效的快取資料，確保獲得最新的分析結果。

---

## 🔧 快取管理指令

### 1. **刪除所有快取**

在 LINE 中輸入：
```
清除快取
```
或
```
刪除快取
```
或
```
clear cache
```

**功能**：刪除資料庫中所有股票的快取資料

**回覆範例**：
```
🔧 快取管理

已刪除所有快取（15 筆）
```

---

### 2. **刪除特定股票快取**

在 LINE 中輸入：
```
刪除快取 2330
```
或
```
清除快取 3003
```
或
```
delete cache 2454
```

**功能**：刪除指定股票代號的快取資料

**回覆範例**：
```
🔧 快取管理

已刪除股票 2330 的快取（1 筆）
```

---

## 📊 使用情境

### 情境 1：圖表顯示錯誤

如果某支股票的圖表無法正常顯示或資料不正確：

```
你：刪除快取 2330
Bot：🔧 快取管理
     已刪除股票 2330 的快取（1 筆）

你：2330
Bot：[顯示重新生成的 2330 分析結果]
```

---

### 情境 2：想要最新資料

如果快取的資料已經過時，想要強制重新抓取最新資料：

```
你：刪除快取 3003
Bot：🔧 快取管理
     已刪除股票 3003 的快取（1 筆）

你：3003
Bot：[顯示最新的 3003 健和興分析結果]
```

---

### 情境 3：清除所有快取

如果想要清除所有股票的快取，重新開始：

```
你：清除快取
Bot：🔧 快取管理
     已刪除所有快取（25 筆）
```

---

## ❓ 常見問題

### Q1：刪除快取後會發生什麼？

**A**：刪除快取後，下次查詢該股票時會：
- 重新從 FinMind 抓取最新股價資料
- 重新計算 KD、MACD 技術指標
- 重新生成圖表
- 重新進行走勢預測
- 將新的結果存入快取

---

### Q2：刪除快取會影響其他用戶嗎？

**A**：會的。快取是所有用戶共用的，刪除後所有用戶下次查詢都會重新生成。

---

### Q3：什麼時候應該刪除快取？

**A**：以下情況建議刪除快取：
- ✅ 圖表無法正常顯示
- ✅ 資料明顯過時或錯誤
- ✅ 想要獲得最新的分析結果
- ✅ 系統更新後想要重新生成

---

### Q4：刪除快取後查詢會變慢嗎？

**A**：是的，刪除快取後首次查詢會需要：
- 抓取資料：約 1-2 秒
- 計算指標：約 0.5 秒
- 生成圖表：約 1-2 秒
- **總計約 3-5 秒**

但之後的查詢會使用新的快取，速度會恢復正常（約 1 秒）。

---

### Q5：快取會自動過期嗎？

**A**：會的。快取有效期為 **12 小時**，超過 12 小時後會自動失效並重新生成。

---

## 💡 最佳實踐

### 建議使用時機

1. **圖表顯示異常**
   - 圖片無法載入
   - 圖表資料明顯錯誤
   - 圖表格式異常

2. **需要最新資料**
   - 盤中想要查看最新股價
   - 重大消息後想要最新分析
   - 快取資料已接近 12 小時

3. **測試新功能**
   - 系統更新後測試
   - 想要驗證新的分析邏輯

---

### 不建議使用時機

1. **頻繁查詢同一支股票**
   - 短時間內多次查詢，使用快取更快
   - 避免浪費 API 配額

2. **資料正常顯示**
   - 如果圖表和資料都正常，不需要刪除快取
   - 快取可以提供更快的回應速度

---

## 🎯 總結

快取管理功能讓你能夠：
- ✅ 清除無效或過時的快取
- ✅ 強制重新生成最新分析
- ✅ 解決圖表顯示問題
- ✅ 確保資料的準確性

**記住**：適度使用快取管理功能，在需要時才清除快取，可以獲得最佳的使用體驗！

