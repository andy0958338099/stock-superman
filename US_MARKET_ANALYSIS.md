# 美股市場分析功能說明

## 📋 概述

股市大亨 LINE Bot 新增美股市場分析功能，整合美股主要指數、台股大盤、匯率、VIX 恐慌指數等資料，進行跨市場技術分析，評估美股對台股的影響。

---

## 🌎 如何使用

在 LINE 中輸入以下任一指令：
```
美股
```
或
```
美股分析
```
或
```
US
```

Bot 會自動：
1. 抓取美股指數資料（S&P500、NASDAQ、SOXX、TSM ADR）
2. 抓取台股加權指數資料
3. 抓取匯率（USD/TWD）和 VIX 指數
4. 計算所有指數的技術指標（KD、MACD、MA）
5. 使用 DeepSeek AI 進行跨市場分析
6. 回覆完整的 Flex Message 分析報告

**⏱️ 處理時間**：約 10-15 秒

---

## 📊 分析內容

### 1. **美股市場狀態**
- 整體趨勢判斷（多頭/空頭/盤整）
- 市場總結說明

### 2. **美股指數詳情**
- **S&P 500**：美國大盤指數
- **NASDAQ**：科技股指數
- **SOXX**：半導體指數
- **TSM ADR**：台積電 ADR

每個指數包含：
- 最新收盤價
- KD 指標（K 值、D 值、狀態）
- MACD 指標（MACD、Signal、Histogram、狀態）
- 趨勢判斷（多頭/空頭/盤整）

### 3. **台股市場狀態**
- 台股加權指數趨勢
- 市場總結說明

### 4. **美台連動性分析**
- 連動分數（0-100 分）
- 連動性分析說明

### 5. **台股走勢預測**

#### 未來 3 天預測
- 方向（上漲/下跌/盤整）
- 機率（0-100%）
- 理由說明

#### 未來 10 天預測
- 方向（上漲/下跌/盤整）
- 機率（0-100%）
- 理由說明

### 6. **投資策略**
- 建議策略（多頭策略/空頭策略/等待策略）
- 推薦族群（半導體、金融、AI、原物料、傳產）

### 7. **風險提示**
- 外資動向
- 匯率波動
- 政策風險
- 量能不足
- 美股回檔

### 8. **關鍵重點**
- 5 個關鍵分析重點

### 9. **操作建議**
- 具體的操作建議（100 字內）

### 10. **市場數據**
- USD/TWD 匯率
- VIX 恐慌指數

---

## 🔧 技術架構

### 資料來源
- **FinMind API**：
  - 美股指數：`USStockPrice` dataset
  - 台股指數：`TaiwanStockPrice` dataset
  - 匯率：`TaiwanExchangeRate` dataset
  - VIX：`USStockPrice` dataset (^VIX)

### 技術指標計算
- **KD 指標**：9 日隨機指標
- **MACD 指標**：12/26/9 參數
- **MA 均線**：5 日、10 日、20 日

### AI 分析
- **DeepSeek AI**：跨市場量化分析
- **分析維度**：
  - 美股技術面
  - 台股技術面
  - 美台連動性
  - 短中期走勢預測
  - 投資策略建議
  - 風險因素評估

---

## 📱 回覆格式

使用 LINE Flex Message 格式，包含：
- 清晰的區塊劃分
- 顏色標示（多頭綠色、空頭紅色、盤整黃色）
- Emoji 圖示
- 完整的資料展示
- 易讀的排版

---

## 💡 使用情境

### 情境 1：盤前準備
```
你：美股
Bot：[顯示完整美股分析報告]
     - 美股昨夜收盤狀態
     - 對台股今日開盤的影響
     - 建議操作策略
```

### 情境 2：盤中觀察
```
你：美股
Bot：[顯示完整美股分析報告]
     - 評估美股對台股的連動性
     - 判斷是否跟隨美股走勢
```

### 情境 3：盤後檢討
```
你：美股
Bot：[顯示完整美股分析報告]
     - 分析今日台股與美股的關係
     - 預測明日可能走勢
```

---

## 🎯 分析邏輯

### 美股狀態判斷
1. **多頭**：MA5 > MA10 > MA20，且價格在均線之上
2. **空頭**：MA5 < MA10 < MA20，且價格在均線之下
3. **盤整**：均線糾結，無明確趨勢

### KD 狀態判斷
- **超買**：K > 80 且 D > 80
- **超賣**：K < 20 且 D < 20
- **偏多**：K > D
- **偏空**：K < D

### MACD 狀態判斷
- **多頭**：Histogram > 0 且 MACD > Signal
- **空頭**：Histogram < 0 且 MACD < Signal
- **中性**：其他情況

### 連動性評估
DeepSeek AI 會根據以下因素評估：
- 美股與台股的趨勢一致性
- TSM ADR 與台積電本體的差異
- 匯率對外資買賣的影響
- VIX 反映的市場風險偏好
- 歷史連動性表現

---

## ⚠️ 注意事項

1. **資料時效性**
   - 美股資料為前一交易日收盤
   - 台股資料為最新交易日
   - 可能有 1-2 天的時間差

2. **分析限制**
   - 僅基於技術指標分析
   - 不包含基本面、消息面
   - AI 分析僅供參考，非投資建議

3. **處理時間**
   - 需要抓取多個資料來源
   - 計算大量技術指標
   - AI 分析需要時間
   - 總計約 10-15 秒

4. **API 限制**
   - FinMind API 有請求限制
   - DeepSeek API 有配額限制
   - 高峰時段可能較慢

---

## 🚀 未來優化方向

1. **快取機制**
   - 美股分析結果快取 1 小時
   - 減少重複計算

2. **更多指標**
   - 美債 10 年利率
   - 美元指數
   - 黃金價格

3. **歷史比對**
   - 與過去類似情況比對
   - 提供歷史勝率

4. **即時推播**
   - 美股重大變化時主動推播
   - 台股開盤前推送分析

---

**🎉 現在就在 LINE 中輸入「美股」試試看吧！**

