# ğŸ“± Rich Menu è¨­ç½®æŒ‡å—ï¼ˆæ–°ç‰ˆï¼‰

> ğŸ‰ **å…¨æ–°è¨­è¨ˆï¼** æ¡ç”¨è¨ˆä¹˜è»Šå¤§äº¨çš„å„ªé›…æ¶æ§‹ï¼Œæ›´æ˜“æ–¼ç¶­è­·å’Œæ“´å±•

## ğŸŒŸ æ–°ç‰ˆç‰¹è‰²

### âœ… å„ªé»
- **æ¨¡çµ„åŒ–è¨­è¨ˆ**ï¼šé…ç½®ã€åœ–ç‰‡ç”Ÿæˆã€API å®Œå…¨åˆ†é›¢
- **æ˜“æ–¼ç¶­è­·**ï¼šä¿®æ”¹é…ç½®åªéœ€ç·¨è¼¯ä¸€å€‹æ–‡ä»¶
- **ç¶²é ç®¡ç†ä»‹é¢**ï¼šç„¡éœ€å‘½ä»¤åˆ—ï¼Œé»æ“Šå³å¯è¨­ç½®
- **SVG ç”Ÿæˆ**ï¼šä½¿ç”¨ SVG ç”Ÿæˆåœ–ç‰‡ï¼Œæ›´æ¸…æ™°ç¾è§€
- **çµ±ä¸€ç®¡ç†**ï¼šæ‰€æœ‰ Rich Menu æ“ä½œé›†ä¸­åœ¨ `lib/line/` ç›®éŒ„

### ğŸ“ æ–°æ¶æ§‹

```
è‚¡å¸‚å¤§äº¨å®Œå…¨ç‰ˆ/
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ line/
â”‚       â”œâ”€â”€ client.js              # LINE Bot Client ç®¡ç†
â”‚       â”œâ”€â”€ rich-menu.js           # Rich Menu é…ç½®èˆ‡æ“ä½œ
â”‚       â””â”€â”€ rich-menu-image.js     # åœ–ç‰‡ç”Ÿæˆå™¨ï¼ˆSVGï¼‰
â”œâ”€â”€ functions/
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ rich-menu-setup.js     # Netlify Function API
â””â”€â”€ public/
    â””â”€â”€ admin/
        â””â”€â”€ rich-menu.html         # ç¶²é ç®¡ç†ä»‹é¢
```

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### æ–¹æ³• 1ï¼šä½¿ç”¨ç¶²é ç®¡ç†ä»‹é¢ï¼ˆæ¨è–¦ï¼‰

1. **å•Ÿå‹•æœ¬åœ°é–‹ç™¼ä¼ºæœå™¨**
   ```bash
   cd è‚¡å¸‚å¤§äº¨å®Œå…¨ç‰ˆ
   netlify dev
   ```

2. **æ‰“é–‹ç®¡ç†ä»‹é¢**
   ```
   http://localhost:8888/admin/rich-menu.html
   ```

3. **é»æ“ŠæŒ‰éˆ•è¨­ç½®**
   - é»æ“Šã€ŒğŸ¨ è¨­ç½®éœæ…‹ Rich Menuã€ï¼ˆæ¨è–¦ï¼‰
   - æˆ–é»æ“Šã€Œâ­ è¨­ç½®å‹•æ…‹ Rich Menuã€ï¼ˆé¡¯ç¤ºè©•åˆ†ï¼‰

4. **å®Œæˆï¼**
   - æŸ¥çœ‹è¨­ç½®çµæœ
   - è¤‡è£½ Rich Menu IDï¼ˆå¦‚éœ€è¦ï¼‰

### æ–¹æ³• 2ï¼šä½¿ç”¨ API ç«¯é»

```bash
# è¨­ç½®éœæ…‹ Rich Menu
curl -X POST http://localhost:8888/.netlify/functions/api/rich-menu-setup \
  -H "Content-Type: application/json" \
  -d '{"action":"setup","mode":"static"}'

# è¨­ç½®å‹•æ…‹ Rich Menuï¼ˆé¡¯ç¤ºè©•åˆ†ï¼‰
curl -X POST http://localhost:8888/.netlify/functions/api/rich-menu-setup \
  -H "Content-Type: application/json" \
  -d '{"action":"setup","mode":"dynamic","avgScore":4.5,"totalVotes":10}'
```

---

## ğŸ¨ è‡ªå®šç¾© Rich Menu

### ä¿®æ”¹æŒ‰éˆ•æ–‡å­—å’Œå‹•ä½œ

ç·¨è¼¯ `lib/line/rich-menu.js`ï¼š

```javascript
const STOCK_RICH_MENU = {
  // ... å…¶ä»–é…ç½®
  areas: [
    {
      bounds: { x: 0, y: 0, width: 833, height: 843 },
      action: {
        type: 'message',
        label: 'å°è‚¡åˆ†æ',      // ä¿®æ”¹é€™è£¡
        text: 'ğŸ“Š å°è‚¡åˆ†æ',    // ä¿®æ”¹é€™è£¡
      },
    },
    // ... å…¶ä»–æŒ‰éˆ•
  ],
};
```

### ä¿®æ”¹åœ–ç‰‡æ¨£å¼

ç·¨è¼¯ `lib/line/rich-menu-image.js`ï¼š

```javascript
function generateStockRichMenuSVG(options = {}) {
  return `
<svg width="2500" height="843" xmlns="http://www.w3.org/2000/svg">
  <!-- ä¿®æ”¹é¡è‰²ã€æ–‡å­—ã€åœ–ç¤ºç­‰ -->
  <rect x="0" y="0" width="833" height="843" fill="#1DB446" opacity="0.1"/>
  <text x="416" y="350" font-size="120" fill="#1DB446">ğŸ“Š</text>
  <text x="416" y="480" font-size="60" fill="#1DB446">å°è‚¡åˆ†æ</text>
</svg>
  `;
}
```

---

## ğŸ“Š éœæ…‹ vs å‹•æ…‹æ¨¡å¼

### éœæ…‹æ¨¡å¼ï¼ˆæ¨è–¦ï¼‰

**ç‰¹é»ï¼š**
- âœ… Rich Menu ID æ°¸é ä¸è®Š
- âœ… ä¸éœ€è¦å®šæœŸæ›´æ–°
- âœ… è¨­ç½®ä¸€æ¬¡å³å¯
- âŒ ä¸é¡¯ç¤ºå³æ™‚è©•åˆ†ï¼ˆé¡¯ç¤ºã€Œé»æ“ŠæŸ¥çœ‹ã€ï¼‰

**é©ç”¨å ´æ™¯ï¼š**
- ç”Ÿç”¢ç’°å¢ƒ
- ä¸éœ€è¦åœ¨ Rich Menu ä¸Šé¡¯ç¤ºè©•åˆ†æ•¸å­—
- ç”¨æˆ¶é»æ“ŠæŒ‰éˆ•å¾Œæœƒçœ‹åˆ°å³æ™‚è©•åˆ†

### å‹•æ…‹æ¨¡å¼

**ç‰¹é»ï¼š**
- âœ… Rich Menu ä¸Šé¡¯ç¤ºå³æ™‚è©•åˆ†
- âŒ éœ€è¦å®šæœŸæ›´æ–°ï¼ˆè©•åˆ†æ”¹è®Šæ™‚ï¼‰
- âŒ Rich Menu ID æœƒæ”¹è®Š
- âŒ éœ€è¦æ›´æ–°ç’°å¢ƒè®Šæ•¸

**é©ç”¨å ´æ™¯ï¼š**
- éœ€è¦åœ¨ Rich Menu ä¸Šç›´æ¥é¡¯ç¤ºè©•åˆ†
- é¡˜æ„å®šæœŸæ›´æ–° Rich Menu

---

## ğŸ”§ é€²éšæ“ä½œ

### åˆ—å‡ºæ‰€æœ‰ Rich Menu

```bash
curl -X POST http://localhost:8888/.netlify/functions/api/rich-menu-setup \
  -H "Content-Type: application/json" \
  -d '{"action":"list"}'
```

### åˆªé™¤ Rich Menu

```bash
curl -X POST http://localhost:8888/.netlify/functions/api/rich-menu-setup \
  -H "Content-Type: application/json" \
  -d '{"action":"delete","richMenuId":"richmenu-xxxxx"}'
```

---

## ğŸŒ éƒ¨ç½²åˆ° Netlify

### 1. è¨­ç½®ç’°å¢ƒè®Šæ•¸

åœ¨ Netlify Dashboard è¨­ç½®ï¼š
```
LINE_CHANNEL_ACCESS_TOKEN=ä½ çš„_Channel_Access_Token
LINE_CHANNEL_SECRET=ä½ çš„_Channel_Secret
```

### 2. éƒ¨ç½²

```bash
git add .
git commit -m "Update Rich Menu system"
git push
```

### 3. ä½¿ç”¨ç·šä¸Šç®¡ç†ä»‹é¢

```
https://ä½ çš„ç¶²ç«™.netlify.app/admin/rich-menu.html
```

---

## ğŸ†š èˆ‡èˆŠç‰ˆçš„å·®ç•°

| ç‰¹æ€§ | èˆŠç‰ˆ | æ–°ç‰ˆ |
|------|------|------|
| é…ç½®æ–¹å¼ | åˆ†æ•£åœ¨å¤šå€‹æ–‡ä»¶ | é›†ä¸­åœ¨ `lib/line/` |
| åœ–ç‰‡ç”Ÿæˆ | Canvas | SVGï¼ˆæ›´æ¸…æ™°ï¼‰ |
| ç®¡ç†æ–¹å¼ | å‘½ä»¤åˆ—è…³æœ¬ | ç¶²é ä»‹é¢ + API |
| æ¨¡çµ„åŒ– | âŒ | âœ… |
| æ˜“æ–¼ç¶­è­· | âŒ | âœ… |
| éŒ¯èª¤è™•ç† | åŸºæœ¬ | å®Œå–„ |

---

## ğŸ“ å¸¸è¦‹å•é¡Œ

### Q: å¦‚ä½•åˆ‡æ›åˆ°æ–°ç‰ˆï¼Ÿ

A: æ–°ç‰ˆèˆ‡èˆŠç‰ˆå¯ä»¥å…±å­˜ã€‚å»ºè­°ï¼š
1. å…ˆä½¿ç”¨æ–°ç‰ˆè¨­ç½® Rich Menu
2. ç¢ºèªé‹ä½œæ­£å¸¸å¾Œ
3. å¯ä»¥ä¿ç•™èˆŠç‰ˆè…³æœ¬ä½œç‚ºå‚™ä»½

### Q: éœ€è¦å®‰è£æ–°çš„å¥—ä»¶å—ï¼Ÿ

A: éœ€è¦ç¢ºä¿å·²å®‰è£ `sharp` å¥—ä»¶ï¼š
```bash
npm install sharp
```

### Q: å¦‚ä½•å›åˆ°èˆŠç‰ˆï¼Ÿ

A: èˆŠç‰ˆè…³æœ¬ä»ç„¶ä¿ç•™åœ¨ `scripts/` ç›®éŒ„ä¸­ï¼Œå¯ä»¥ç¹¼çºŒä½¿ç”¨ã€‚

---

## ğŸ¯ å»ºè­°ä½¿ç”¨æµç¨‹

1. **é–‹ç™¼éšæ®µ**ï¼šä½¿ç”¨ç¶²é ç®¡ç†ä»‹é¢æ¸¬è©¦
2. **ç”Ÿç”¢ç’°å¢ƒ**ï¼šä½¿ç”¨éœæ…‹æ¨¡å¼è¨­ç½®ä¸€æ¬¡
3. **éœ€è¦æ›´æ–°**ï¼šé‡æ–°è¨ªå•ç®¡ç†ä»‹é¢ï¼Œé»æ“Šè¨­ç½®

---

## ğŸ“ æŠ€è¡“æ”¯æ´

å¦‚æœ‰å•é¡Œï¼Œè«‹æª¢æŸ¥ï¼š
1. ç’°å¢ƒè®Šæ•¸æ˜¯å¦æ­£ç¢ºè¨­ç½®
2. `sharp` å¥—ä»¶æ˜¯å¦å·²å®‰è£
3. LINE Channel Access Token æ˜¯å¦æœ‰æ•ˆ
4. æŸ¥çœ‹ Netlify Function æ—¥èªŒ

