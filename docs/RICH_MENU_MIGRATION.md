# ğŸ”„ Rich Menu ç³»çµ±é·ç§»æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—èªªæ˜å¦‚ä½•å¾èˆŠç‰ˆ Rich Menu ç³»çµ±é·ç§»åˆ°æ–°ç‰ˆç³»çµ±ã€‚

---

## ğŸ†š ä¸»è¦å·®ç•°å°æ¯”

### èˆŠç‰ˆæ¶æ§‹
```
è‚¡å¸‚å¤§äº¨å®Œå…¨ç‰ˆ/
â”œâ”€â”€ functions/
â”‚   â””â”€â”€ rich-menu-manager.js      # æ··åˆäº†é…ç½®å’Œæ“ä½œ
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ setup-rich-menu.js        # è¨­ç½®è…³æœ¬
â”‚   â”œâ”€â”€ generate-rich-menu-image.js  # åœ–ç‰‡ç”Ÿæˆ
â”‚   â””â”€â”€ update-*.js               # å¤šå€‹æ›´æ–°è…³æœ¬
```

**å•é¡Œï¼š**
- âŒ é…ç½®åˆ†æ•£åœ¨å¤šå€‹æ–‡ä»¶
- âŒ ä¿®æ”¹å›°é›£ï¼Œéœ€è¦æ”¹å¤šè™•
- âŒ åªèƒ½ç”¨å‘½ä»¤åˆ—æ“ä½œ
- âŒ ä½¿ç”¨ Canvas ç”Ÿæˆåœ–ç‰‡ï¼ˆè¼ƒè¤‡é›œï¼‰

### æ–°ç‰ˆæ¶æ§‹
```
è‚¡å¸‚å¤§äº¨å®Œå…¨ç‰ˆ/
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ line/
â”‚       â”œâ”€â”€ client.js              # çµ±ä¸€çš„ Client ç®¡ç†
â”‚       â”œâ”€â”€ rich-menu.js           # é…ç½®èˆ‡æ“ä½œåˆ†é›¢
â”‚       â””â”€â”€ rich-menu-image.js     # SVG åœ–ç‰‡ç”Ÿæˆ
â”œâ”€â”€ functions/
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ rich-menu-setup.js     # çµ±ä¸€çš„ API ç«¯é»
â””â”€â”€ public/
    â””â”€â”€ admin/
        â””â”€â”€ rich-menu.html         # ç¶²é ç®¡ç†ä»‹é¢
```

**å„ªé»ï¼š**
- âœ… é…ç½®é›†ä¸­åœ¨ä¸€å€‹æ–‡ä»¶
- âœ… æ¨¡çµ„åŒ–è¨­è¨ˆï¼Œæ˜“æ–¼ç¶­è­·
- âœ… æä¾›ç¶²é ç®¡ç†ä»‹é¢
- âœ… ä½¿ç”¨ SVG ç”Ÿæˆåœ–ç‰‡ï¼ˆæ›´ç°¡å–®æ¸…æ™°ï¼‰
- âœ… çµ±ä¸€çš„ API ç«¯é»

---

## ğŸš€ é·ç§»æ­¥é©Ÿ

### æ­¥é©Ÿ 1ï¼šç¢ºèªç’°å¢ƒ

ç¢ºä¿å·²å®‰è£å¿…è¦çš„å¥—ä»¶ï¼š

```bash
cd è‚¡å¸‚å¤§äº¨å®Œå…¨ç‰ˆ
npm install sharp
```

### æ­¥é©Ÿ 2ï¼šæ¸¬è©¦æ–°ç‰ˆç³»çµ±

å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨ï¼š

```bash
npm run dev
```

æ‰“é–‹ç€è¦½å™¨è¨ªå•ï¼š
```
http://localhost:8888/admin/rich-menu.html
```

### æ­¥é©Ÿ 3ï¼šè¨­ç½®æ–°ç‰ˆ Rich Menu

åœ¨ç®¡ç†ä»‹é¢ä¸­ï¼š
1. é»æ“Šã€ŒğŸ¨ è¨­ç½®éœæ…‹ Rich Menuã€
2. ç­‰å¾…è¨­ç½®å®Œæˆ
3. è¨˜éŒ„æ–°çš„ Rich Menu IDï¼ˆå¦‚éœ€è¦ï¼‰

### æ­¥é©Ÿ 4ï¼šé©—è­‰åŠŸèƒ½

åœ¨ LINE App ä¸­ï¼š
1. æ‰“é–‹è‚¡å¸‚å¤§äº¨ Bot
2. æª¢æŸ¥ Rich Menu æ˜¯å¦æ­£ç¢ºé¡¯ç¤º
3. æ¸¬è©¦æ¯å€‹æŒ‰éˆ•æ˜¯å¦æ­£å¸¸å·¥ä½œ

### æ­¥é©Ÿ 5ï¼šæ›´æ–°éƒ¨ç½²æµç¨‹ï¼ˆå¯é¸ï¼‰

å¦‚æœä½¿ç”¨ CI/CDï¼Œæ›´æ–°éƒ¨ç½²è…³æœ¬ä½¿ç”¨æ–°çš„ API ç«¯é»ã€‚

---

## ğŸ“ åŠŸèƒ½å°ç…§è¡¨

| èˆŠç‰ˆå‘½ä»¤ | æ–°ç‰ˆæ–¹å¼ | èªªæ˜ |
|---------|---------|------|
| `npm run setup:richmenu` | ç¶²é ä»‹é¢ | ä½¿ç”¨ `/admin/rich-menu.html` |
| `npm run setup:richmenu:static` | ç¶²é ä»‹é¢ï¼ˆéœæ…‹æ¨¡å¼ï¼‰ | é»æ“Šã€Œè¨­ç½®éœæ…‹ Rich Menuã€ |
| `npm run generate:richmenu` | è‡ªå‹•ç”Ÿæˆ | API è‡ªå‹•èª¿ç”¨åœ–ç‰‡ç”Ÿæˆå™¨ |
| `npm run update:richmenu` | ç¶²é ä»‹é¢ | é‡æ–°è¨­ç½®å³å¯ |

---

## ğŸ”§ é…ç½®ä¿®æ”¹å°ç…§

### ä¿®æ”¹ Rich Menu æŒ‰éˆ•æ–‡å­—

**èˆŠç‰ˆï¼š**
```javascript
// functions/rich-menu-manager.js
const richMenu = {
  areas: [
    {
      action: {
        type: 'message',
        text: 'ğŸ“Š å°è‚¡åˆ†æ'  // éœ€è¦åœ¨é€™è£¡ä¿®æ”¹
      }
    }
  ]
};
```

**æ–°ç‰ˆï¼š**
```javascript
// lib/line/rich-menu.js
const STOCK_RICH_MENU = {
  areas: [
    {
      action: {
        type: 'message',
        label: 'å°è‚¡åˆ†æ',      // åœ¨é€™è£¡ä¿®æ”¹
        text: 'ğŸ“Š å°è‚¡åˆ†æ',    // åœ¨é€™è£¡ä¿®æ”¹
      },
    },
  ],
};
```

### ä¿®æ”¹åœ–ç‰‡æ¨£å¼

**èˆŠç‰ˆï¼š**
```javascript
// scripts/generate-rich-menu-image.js
// ä½¿ç”¨ Canvas APIï¼ˆè¼ƒè¤‡é›œï¼‰
const canvas = createCanvas(WIDTH, HEIGHT);
const ctx = canvas.getContext('2d');
ctx.fillStyle = '#1DB446';
ctx.fillRect(x, y, width, height);
// ... æ›´å¤š Canvas æ“ä½œ
```

**æ–°ç‰ˆï¼š**
```javascript
// lib/line/rich-menu-image.js
// ä½¿ç”¨ SVGï¼ˆæ›´ç°¡å–®ï¼‰
function generateStockRichMenuSVG() {
  return `
<svg width="2500" height="843">
  <rect x="0" y="0" width="833" height="843" fill="#1DB446" opacity="0.1"/>
  <text x="416" y="350" fill="#1DB446">ğŸ“Š</text>
</svg>
  `;
}
```

---

## ğŸ¯ å»ºè­°é·ç§»ç­–ç•¥

### ç­–ç•¥ Aï¼šå®Œå…¨é·ç§»ï¼ˆæ¨è–¦ï¼‰

1. âœ… ä½¿ç”¨æ–°ç‰ˆç³»çµ±è¨­ç½® Rich Menu
2. âœ… é©—è­‰åŠŸèƒ½æ­£å¸¸
3. âœ… ä¿ç•™èˆŠç‰ˆè…³æœ¬ä½œç‚ºå‚™ä»½
4. âœ… æ›´æ–°åœ˜éšŠæ–‡æª”

**å„ªé»ï¼š**
- äº«å—æ–°ç‰ˆæ‰€æœ‰å„ªå‹¢
- æ›´æ˜“æ–¼ç¶­è­·

### ç­–ç•¥ Bï¼šæ¼¸é€²å¼é·ç§»

1. âœ… æ–°ç‰ˆå’ŒèˆŠç‰ˆä¸¦å­˜
2. âœ… å…ˆåœ¨é–‹ç™¼ç’°å¢ƒæ¸¬è©¦æ–°ç‰ˆ
3. âœ… ç¢ºèªç©©å®šå¾Œå†ç”¨æ–¼ç”Ÿç”¢ç’°å¢ƒ
4. âœ… é€æ­¥æ·˜æ±°èˆŠç‰ˆ

**å„ªé»ï¼š**
- é¢¨éšªè¼ƒä½
- å¯ä»¥éš¨æ™‚å›é€€

---

## âš ï¸ æ³¨æ„äº‹é …

### 1. Rich Menu ID æœƒæ”¹è®Š

ä½¿ç”¨æ–°ç‰ˆè¨­ç½®å¾Œï¼Œæœƒç”¢ç”Ÿæ–°çš„ Rich Menu IDã€‚å¦‚æœæœ‰ç¡¬ç·¨ç¢¼ ID çš„åœ°æ–¹éœ€è¦æ›´æ–°ã€‚

### 2. ç’°å¢ƒè®Šæ•¸

ç¢ºä¿ä»¥ä¸‹ç’°å¢ƒè®Šæ•¸å·²è¨­ç½®ï¼š
```
LINE_CHANNEL_ACCESS_TOKEN=ä½ çš„_Token
LINE_CHANNEL_SECRET=ä½ çš„_Secret
```

### 3. Sharp å¥—ä»¶

æ–°ç‰ˆä½¿ç”¨ `sharp` å¥—ä»¶è½‰æ› SVG ç‚º PNGï¼Œç¢ºä¿å·²å®‰è£ï¼š
```bash
npm install sharp
```

### 4. èˆŠç‰ˆè…³æœ¬ä¿ç•™

å»ºè­°ä¿ç•™èˆŠç‰ˆè…³æœ¬åœ¨ `scripts/` ç›®éŒ„ä½œç‚ºå‚™ä»½ï¼Œä¸è¦åˆªé™¤ã€‚

---

## ğŸ› å¸¸è¦‹å•é¡Œ

### Q: é·ç§»å¾ŒèˆŠçš„ Rich Menu é‚„åœ¨å—ï¼Ÿ

A: æ˜¯çš„ï¼ŒèˆŠçš„ Rich Menu ä»ç„¶å­˜åœ¨æ–¼ LINE ä¼ºæœå™¨ä¸Šã€‚æ–°ç‰ˆæœƒå‰µå»ºæ–°çš„ Rich Menu ä¸¦è¨­ç‚ºé è¨­ã€‚

### Q: å¦‚ä½•åˆªé™¤èˆŠçš„ Rich Menuï¼Ÿ

A: ä½¿ç”¨æ–°ç‰ˆ APIï¼š
```bash
curl -X POST http://localhost:8888/.netlify/functions/api/rich-menu-setup \
  -H "Content-Type: application/json" \
  -d '{"action":"list"}'  # å…ˆåˆ—å‡ºæ‰€æœ‰ Rich Menu

curl -X POST http://localhost:8888/.netlify/functions/api/rich-menu-setup \
  -H "Content-Type: application/json" \
  -d '{"action":"delete","richMenuId":"èˆŠçš„ID"}'
```

### Q: å¯ä»¥åŒæ™‚ä½¿ç”¨æ–°èˆŠç‰ˆå—ï¼Ÿ

A: å¯ä»¥ï¼Œä½†å»ºè­°çµ±ä¸€ä½¿ç”¨æ–°ç‰ˆä»¥é¿å…æ··æ·†ã€‚

### Q: é·ç§»å¤±æ•—æ€éº¼è¾¦ï¼Ÿ

A: å¯ä»¥ä½¿ç”¨èˆŠç‰ˆè…³æœ¬å›é€€ï¼š
```bash
npm run setup:richmenu:static
```

---

## ğŸ“ éœ€è¦å¹«åŠ©ï¼Ÿ

å¦‚æœé·ç§»éç¨‹ä¸­é‡åˆ°å•é¡Œï¼š

1. æª¢æŸ¥ Netlify Function æ—¥èªŒ
2. ç¢ºèªç’°å¢ƒè®Šæ•¸è¨­ç½®æ­£ç¢º
3. ç¢ºèª `sharp` å¥—ä»¶å·²å®‰è£
4. æŸ¥çœ‹ `docs/RICH_MENU_SETUP_NEW.md` è©³ç´°æ–‡æª”

---

## âœ… é·ç§»æª¢æŸ¥æ¸…å–®

- [ ] å®‰è£ `sharp` å¥—ä»¶
- [ ] å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨æ¸¬è©¦
- [ ] ä½¿ç”¨ç¶²é ä»‹é¢è¨­ç½®æ–° Rich Menu
- [ ] åœ¨ LINE App ä¸­é©—è­‰åŠŸèƒ½
- [ ] è¨˜éŒ„æ–°çš„ Rich Menu ID
- [ ] æ›´æ–°åœ˜éšŠæ–‡æª”
- [ ] ï¼ˆå¯é¸ï¼‰åˆªé™¤èˆŠçš„ Rich Menu
- [ ] ï¼ˆå¯é¸ï¼‰æ›´æ–° CI/CD æµç¨‹

